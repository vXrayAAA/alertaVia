<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlertaVia - Teste Simples</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .widget { background: #f5f5f5; padding: 15px; margin: 10px 0; border-radius: 8px; }
        .btn { padding: 8px 16px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        .status-indicator { padding: 10px; border-radius: 6px; }
        .status-indicator.online { background: #d4edda; color: #155724; }
        .status-indicator.offline { background: #f8d7da; color: #721c24; }
        .status-indicator.degraded { background: #fff3cd; color: #856404; }
        .status-indicator.connecting { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>AlertaVia - Teste Simples</h1>
    
    <div class="widget">
        <h3>Widget Meteorol√≥gico</h3>
        <div>
            <span id="weather-temp">Carregando...</span> | 
            <span id="weather-condition">Aguardando dados</span> | 
            <span id="weather-humidity">Umidade: --</span>
        </div>
        <button class="btn" onclick="testWeather()">Testar Widget</button>
    </div>
    
    <div class="widget">
        <h3>Status de Conex√£o</h3>
        <div class="status-indicator connecting" id="connection-status">
            üîÑ Conectando...
        </div>
        <button class="btn" onclick="testStatus('online')">Online</button>
        <button class="btn" onclick="testStatus('offline')">Offline</button>
        <button class="btn" onclick="testStatus('degraded')">Inst√°vel</button>
    </div>

    <div class="widget">
        <h3>Debug</h3>
        <div id="debug-output" style="background: #333; color: white; padding: 10px; font-family: monospace; height: 200px; overflow-y: auto;"></div>
        <button class="btn" onclick="clearDebug()">Limpar</button>
    </div>

    <script>
        // Sistema de debug
        function log(message) {
            const output = document.getElementById('debug-output');
            const time = new Date().toLocaleTimeString();
            output.innerHTML += `[${time}] ${message}<br>`;
            output.scrollTop = output.scrollHeight;
            console.log(message);
        }

        function clearDebug() {
            document.getElementById('debug-output').innerHTML = '';
        }

        // Fun√ß√µes de teste
        function displayWeatherInfo(weatherData) {
            log('üå§Ô∏è Atualizando display meteorol√≥gico: ' + JSON.stringify(weatherData));

            const tempElement = document.getElementById('weather-temp');
            const conditionElement = document.getElementById('weather-condition');
            const humidityElement = document.getElementById('weather-humidity');

            if (tempElement) {
                tempElement.textContent = `${weatherData.temperature || 'N/A'}¬∞C`;
                log('‚úÖ Temperatura atualizada');
            } else {
                log('‚ùå Elemento weather-temp n√£o encontrado');
            }

            if (conditionElement) {
                const condition = weatherData.condition || 'Indispon√≠vel';
                conditionElement.textContent = condition;
                log('‚úÖ Condi√ß√£o atualizada');
            } else {
                log('‚ùå Elemento weather-condition n√£o encontrado');
            }

            if (humidityElement) {
                humidityElement.textContent = `Umidade: ${weatherData.humidity || 'N/A'}%`;
                log('‚úÖ Umidade atualizada');
            } else {
                log('‚ùå Elemento weather-humidity n√£o encontrado');
            }

            log('‚úÖ Interface meteorol√≥gica atualizada com sucesso');
        }

        function updateServerStatus(status) {
            log(`üì° Atualizando status de conex√£o: ${status}`);

            const indicator = document.getElementById('connection-status');
            
            if (!indicator) {
                log('‚ùå Elemento connection-status n√£o encontrado');
                return;
            }

            indicator.className = `status-indicator ${status}`;
            
            const statusText = {
                online: 'üü¢ Online',
                degraded: 'üü° Inst√°vel', 
                offline: 'üî¥ Offline',
                connecting: 'üîÑ Conectando...'
            };

            const currentTime = new Date().toLocaleTimeString('pt-BR');
            indicator.innerHTML = `
                ${statusText[status] || statusText.offline}
                <small><br>√öltima verifica√ß√£o: ${currentTime}</small>
            `;

            log('‚úÖ Status de conex√£o atualizado na interface');
        }

        // Fun√ß√µes de teste para os bot√µes
        function testWeather() {
            log('üß™ Testando widget meteorol√≥gico...');
            displayWeatherInfo({
                temperature: Math.round(20 + Math.random() * 15),
                condition: 'Ensolarado',
                humidity: Math.round(50 + Math.random() * 40)
            });
        }

        function testStatus(status) {
            log(`üß™ Testando status: ${status}`);
            updateServerStatus(status);
        }

        // Inicializa√ß√£o
        log('üöÄ P√°gina carregada, fun√ß√µes de teste prontas');
        log('üí° Clique nos bot√µes para testar as fun√ß√µes');
        
        // Teste autom√°tico inicial
        setTimeout(() => {
            log('üîÑ Executando teste autom√°tico...');
            testWeather();
            setTimeout(() => testStatus('online'), 1000);
        }, 1000);
    </script>
</body>
</html>
